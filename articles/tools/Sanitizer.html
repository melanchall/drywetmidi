<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Sanitizer | DryWetMIDI </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Sanitizer | DryWetMIDI ">
    
    
      <link rel="shortcut icon" href="../../images/favicon.png">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="a_sanitizer">
<h1 id="sanitizer">Sanitizer</h1>

<p>DryWetMIDI provides a tool to clean a MIDI file by removing redundant events and so on â€“ <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.Sanitizer.html">Sanitizer</a>. The process can be run via the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.Sanitizer.html#Melanchall_DryWetMidi_Tools_Sanitizer_Sanitize_">Sanitize</a> extension method:</p>
<pre><code class="lang-csharp">midiFile.Sanitize();
</code></pre>
<p>It's a simple example that shows how you can perform all supported cleaning procedures. You can pass an instance of the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html">SanitizingSettings</a> to the method turning off or on desired options:</p>
<pre><code class="lang-csharp">midiFile.Sanitize(new SanitizingSettings
{
    NoteMinLength = MusicalTimeSpan.Quarter,
    RemoveEmptyTrackChunks = false
});
</code></pre>
<p>Here we're removing all notes that are shorter than <code>1/4</code> leaving track chunks without events untouched. Please see detailed descriptions of settings below.</p>
<h2 id="settings">Settings</h2>
<p>The <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.Sanitizer.html">Sanitizer</a> class provides a rich set of options you can manage sanitizing of a MIDI file with.</p>
<h3 id="noteminlength">NoteMinLength</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_NoteMinLength">NoteMinLength</a> property of the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html">SanitizingSettings</a> sets a minimum length for notes within an input file. All notes that are shorter than this value will be removed.</p>
<p>The default value is <code>null</code> which means notes can have any length. The same behavior can be achieved with a value of zero length. This should be read as &quot;a note should not be removed if its length is zero or greater&quot;.</p>
<p>Image below shows how you can get rid of short notes with this option:</p>
<p><img src="images/Sanitizer/NoteMinLength.png" alt="SanitizingSettings.NoteMinLength"></p>
<p>Please notice that how notes will be detected is handled by the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_NoteDetectionSettings">NoteDetectionSettings</a> property. You can read more about the <a class="xref" href="../../api/Melanchall.DryWetMidi.Interaction.NoteDetectionSettings.html">NoteDetectionSettings</a> class in the <a class="xref" href="../high-level-managing/Getting-objects.html#settings">Getting objects: GetNotes: Settings</a> article.</p>
<h3 id="noteminvelocity">NoteMinVelocity</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_NoteMinVelocity">NoteMinVelocity</a> property of the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html">SanitizingSettings</a> sets a minimum velocity for notes within an input file. All notes with velocity below this value will be removed. The default value is zero which means notes can have any velocity (zero or above).</p>
<p>For example, if we have such a file with two notes (with numbers of <code>70</code> and <code>50</code>):</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new NoteOnEvent((SevenBitNumber)70, (SevenBitNumber)50),
        new NoteOffEvent((SevenBitNumber)70, (SevenBitNumber)0),
        new NoteOnEvent((SevenBitNumber)50, (SevenBitNumber)40),
        new NoteOffEvent((SevenBitNumber)50, (SevenBitNumber)0)));
</code></pre>
<p>then this instruction will remove the second one:</p>
<pre><code class="lang-csharp">midiFile.Sanitize(new SanitizingSettings
{
    NoteMinVelocity = (SevenBitNumber)45
});
</code></pre>
<h3 id="removeduplicatednotes">RemoveDuplicatedNotes</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedNotes">RemoveDuplicatedNotes</a> property of the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html">SanitizingSettings</a> determines whether duplicated notes should be removed or not. The default value is <code>true</code>.</p>
<p>Notes are considered duplicated when they are meet all the following conditions:</p>
<ul>
<li>same note number;</li>
<li>same channel;</li>
<li>same time;</li>
<li>same length.</li>
</ul>
<p>For example, if we have such a file with two notes (with number of <code>70</code> and length of <code>20</code>):</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new NoteOnEvent((SevenBitNumber)70, (SevenBitNumber)50),
        new NoteOnEvent((SevenBitNumber)70, (SevenBitNumber)40),
        new NoteOffEvent((SevenBitNumber)70, (SevenBitNumber)0) { DeltaTime = 20 },
        new NoteOffEvent((SevenBitNumber)70, (SevenBitNumber)0)));
</code></pre>
<p>then this instruction will remove the second one:</p>
<pre><code class="lang-csharp">midiFile.Sanitize();
</code></pre>
<h3 id="removeemptytrackchunks">RemoveEmptyTrackChunks</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveEmptyTrackChunks">RemoveEmptyTrackChunks</a> property determines whether track chunks without MIDI events should be removed or not.</p>
<h3 id="orphanednoteoneventspolicy">OrphanedNoteOnEventsPolicy</h3>
<p>In some MIDI files you can encounter <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.NoteOnEvent.html">Note On</a> events without corresponding <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.NoteOffEvent.html">Note Off</a> ones. For example, here we're creating a file with the first event is an orphaned <em>Note On</em> one:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new NoteOnEvent(),
        new TextEvent(&quot;A&quot;)));
</code></pre>
<p>Of course how notes are detected is controlled by the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_NoteDetectionSettings">NoteDetectionSettings</a> property. As stated above you can read more about the <a class="xref" href="../../api/Melanchall.DryWetMidi.Interaction.NoteDetectionSettings.html">NoteDetectionSettings</a> class in the <a class="xref" href="../high-level-managing/Getting-objects.html#settings">Getting objects: GetNotes: Settings</a> article.</p>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.Sanitizer.html">Sanitizer</a> allows to handle such orphaned <em>Note On</em> events in different ways with the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_OrphanedNoteOnEventsPolicy">OrphanedNoteOnEventsPolicy</a> property.</p>
<p>Following image shows how <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.OrphanedNoteOnEventsPolicy.html#Melanchall_DryWetMidi_Tools_OrphanedNoteOnEventsPolicy_Remove">OrphanedNoteOnEventsPolicy.Remove</a> option (which is the default one) works:</p>
<p><img src="images/Sanitizer/OrphanedNoteOnEvents_Remove.png" alt="SanitizingSettings.OrphanedNoteOnEventsPolicy.Remove"></p>
<p>But what if such orphaned Note On events are just a result of corresponding Note Off ones were lost for some reason? You'll probably want to restore notes. In this case you can use <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.OrphanedNoteOnEventsPolicy.html#Melanchall_DryWetMidi_Tools_OrphanedNoteOnEventsPolicy_CompleteNote">OrphanedNoteOnEventsPolicy.CompleteNote</a> option. It will add a <em>Note Off</em> event for each orphaned <em>Note On</em> one. The length of the note is controlled by the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_NoteMaxLengthForOrphanedNoteOnEvent">NoteMaxLengthForOrphanedNoteOnEvent</a> property. Please see the image below which describes the process:</p>
<p><img src="images/Sanitizer/OrphanedNoteOnEvents_CompleteNote.png" alt="SanitizingSettings.OrphanedNoteOnEventsPolicy.CompleteNote"></p>
<p>As you can see from the name of the property, it's the <strong>maximum</strong> length of a note. If Note On event with the same channel and note number is encountered during the new note, the note's length will be reduced so its end will be at the start of a next note:</p>
<p><img src="images/Sanitizer/NoteMaxLengthForOrphanedNoteOnEvent.png" alt="SanitizingSettings.NoteMaxLengthForOrphanedNoteOnEvent"></p>
<h3 id="removeorphanednoteoffevents">RemoveOrphanedNoteOffEvents</h3>
<p>Obviously <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.NoteOffEvent.html">Note Off</a> events can be orphaned too (see <a href="#orphanednoteoneventspolicy">OrphanedNoteOnEventsPolicy</a> above) and you can remove such events too using the <a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveOrphanedNoteOffEvents">RemoveOrphanedNoteOffEvents</a> property:</p>
<p><img src="images/Sanitizer/RemoveOrphanedNoteOffEvents.png" alt="SanitizingSettings.RemoveOrphanedNoteOffEvents"></p>
<h3 id="removeduplicatedsettempoevents">RemoveDuplicatedSetTempoEvents</h3>
<p>If we create a MIDI file like that:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new SetTempoEvent(100),
        new TextEvent(&quot;A&quot;),
        new SetTempoEvent(100),
        new TextEvent(&quot;B&quot;),
        new SetTempoEvent(200),
        new TextEvent(&quot;C&quot;),
        new SetTempoEvent(200)));
</code></pre>
<p>we'll notice that the second and last <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.SetTempoEvent.html">Set Tempo</a> events are redundant. The file above is equivalent to this one:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new SetTempoEvent(100),
        new TextEvent(&quot;A&quot;),
        new TextEvent(&quot;B&quot;),
        new SetTempoEvent(200),
        new TextEvent(&quot;C&quot;)));
</code></pre>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedSetTempoEvents">RemoveDuplicatedSetTempoEvents</a> property allows to remove redundant <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.SetTempoEvent.html">Set Tempo</a> events:</p>
<p><img src="images/Sanitizer/RemoveDuplicatedSetTempoEvents.png" alt="SanitizingSettings.RemoveDuplicatedSetTempoEvents"></p>
<p>So <em>Set Tempo</em> events are considered duplicated when they are have the same microseconds per quarter note value.</p>
<h3 id="removeduplicatedtimesignatureevents">RemoveDuplicatedTimeSignatureEvents</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedTimeSignatureEvents">RemoveDuplicatedTimeSignatureEvents</a> does the same actions as the <a href="#removeduplicatedsettempoevents">RemoveDuplicatedSetTempoEvents</a> one but for duplicated <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.TimeSignatureEvent.html">Time Signature</a> events.</p>
<p><em>Time Signature</em> events are considered duplicated when they are meet all the following conditions:</p>
<ul>
<li>same numerator;</li>
<li>same denominator;</li>
<li>same clock ticks per click;</li>
<li>same thirty-second notes per beat.</li>
</ul>
<h3 id="removeduplicatedpitchbendevents">RemoveDuplicatedPitchBendEvents</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedPitchBendEvents">RemoveDuplicatedPitchBendEvents</a> does the same actions as the <a href="#removeduplicatedsettempoevents">RemoveDuplicatedSetTempoEvents</a> or <a href="#removeduplicatedtimesignatureevents">RemoveDuplicatedTimeSignatureEvents</a> one but for duplicated <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.PitchBendEvent.html">Pitch Bend</a> events.</p>
<p><em>Pitch Bend</em> events are considered duplicated when they are meet all the following conditions:</p>
<ul>
<li>same pitch value;</li>
<li>same channel.</li>
</ul>
<h3 id="removeduplicatedsequencetracknameevents">RemoveDuplicatedSequenceTrackNameEvents</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedSequenceTrackNameEvents">RemoveDuplicatedSequenceTrackNameEvents</a> does the same actions as the <a href="#removeduplicatedsettempoevents">RemoveDuplicatedSetTempoEvents</a> or <a href="#removeduplicatedtimesignatureevents">RemoveDuplicatedTimeSignatureEvents</a> one but for duplicated <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.SequenceTrackNameEvent.html">Sequence/Track Name</a> events.</p>
<p><em>Sequence/Track Name</em> events are considered duplicated when they have the same text.</p>
<h3 id="removeduplicatedcontrolchangeevents">RemoveDuplicatedControlChangeEvents</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveDuplicatedControlChangeEvents">RemoveDuplicatedControlChangeEvents</a> does the same actions as the <a href="#removeduplicatedsettempoevents">RemoveDuplicatedSetTempoEvents</a> or <a href="#removeduplicatedtimesignatureevents">RemoveDuplicatedTimeSignatureEvents</a> one but for duplicated <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.ControlChangeEvent.html">Control Change</a> events.</p>
<p><em>Control Change</em> events are considered duplicated when they are meet all the following conditions:</p>
<ul>
<li>same control number;</li>
<li>same control value;</li>
<li>same channel.</li>
</ul>
<h3 id="removeeventsonunusedchannels">RemoveEventsOnUnusedChannels</h3>
<p>If a MIDI file doesn't contain notes on some channel, we can safely remove all events on that channel. For example, the <a class="xref" href="../../api/Melanchall.DryWetMidi.Core.ControlChangeEvent.html">Control Change</a> event on channel <code>2</code> in the following example is redundant:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new ControlChangeEvent { Channel = (FourBitNumber)2 },
        new ControlChangeEvent { Channel = (FourBitNumber)5 },
        new NoteOnEvent { Channel = (FourBitNumber)5 },
        new NoteOffEvent { Channel = (FourBitNumber)5 }));
</code></pre>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_RemoveEventsOnUnusedChannels">RemoveEventsOnUnusedChannels</a> property turns on or off removing such channel events that have no effect since there are no notes on those channels:</p>
<p><img src="images/Sanitizer/RemoveEventsOnUnusedChannels.png" alt="SanitizingSettings.RemoveEventsOnUnusedChannels"></p>
<h3 id="trim">Trim</h3>
<p><a class="xref" href="../../api/Melanchall.DryWetMidi.Tools.SanitizingSettings.html#Melanchall_DryWetMidi_Tools_SanitizingSettings_Trim">Trim</a> property allows to automatically remove an empty space at the start of a MIDI file. For example:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new TextEvent(&quot;A&quot;) { DeltaTime = 20 }),
    new TrackChunk(
        new TextEvent(&quot;B&quot;) { DeltaTime = 30 },
        new TextEvent(&quot;C&quot;) { DeltaTime = 15 }));
</code></pre>
<p>Here we have a silence of 20 ticks at the start of the file. So after sanitizing with <code>Trim</code> property set to <code>true</code> we will have this file:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new TextEvent(&quot;A&quot;) { DeltaTime = 0 }),
    new TrackChunk(
        new TextEvent(&quot;B&quot;) { DeltaTime = 10 },
        new TextEvent(&quot;C&quot;) { DeltaTime = 15 }));
</code></pre>
<p>The default value is <code>false</code> since this behavior can be undesired.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      2025 / Generated by <a href="https://dotnet.github.io/docfx">DocFX</a>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
