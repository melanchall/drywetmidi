<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Using in Unity | DryWetMIDI </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Using in Unity | DryWetMIDI ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="a_develop_unity">
<h1 id="using-in-unity">Using in Unity</h1>

<p>This article describes how to integrate DryWetMIDI in a Unity project. You have two main ways:</p>
<ul>
<li>import the <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-222171">DryWetMIDI asset</a> (or <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-nativeless-228998">DryWetMIDI.Nativeless</a> one) from the Unity Asset Store;</li>
<li>install the library manually.</li>
</ul>
<p>There are also ways to import a NuGet package via 3d party tools (for example, <a href="https://github.com/GlitchEnzo/NuGetForUnity">NuGetForUnity</a>).</p>
<h2 id="unity-asset">Unity asset</h2>
<p>It's the simplest way. Just use built-in ways to import the official <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-222171">DryWetMIDI asset</a> (or <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-nativeless-228998">DryWetMIDI.Nativeless</a> one) into your Unity project from the Asset Store.</p>
<h2 id="manual-installation">Manual installation</h2>
<p>Instruction below shows how to integrate full version of the DryWetMIDI into your Unity project manually. If you want to use the <a class="xref" href="Nativeless-package.html">nativeless version</a>, just take an archive with <em>-nativeless</em> suffix on the second step and skip third one.</p>
<ol>
<li><p>Create <em>Melanchall</em> folder in project's <em>Assets</em> folder and <em>DryWetMIDI</em> subfolder within the <em>Melanchall</em> one.</p>
</li>
<li><p>Download the library main binary:</p>
<ul>
<li>for <em>master</em> branch take <em>DryWetMIDI.&lt;release_number&gt;-bin-netstandard20.zip</em> archive from <a href="https://github.com/melanchall/drywetmidi/releases">Releases</a> (<em>&lt;release_number&gt;</em> is the number of the library release you want to take binaries of);</li>
<li>for <em>develop</em> branch go to <a href="https://dev.azure.com/Melanchall/DryWetMIDI/_build/latest?definitionId=6&amp;branchName=develop">https://dev.azure.com/Melanchall/DryWetMIDI/_build/latest?definitionId=6&amp;branchName=develop</a> and download <em>DryWetMIDI.&lt;release_number&gt;-bin-netstandard20.zip</em> from <code>Artifacts</code> → <code>Binaries</code>.</li>
</ul>
</li>
<li><p>Download native binaries required to work with MIDI devices and default playback:</p>
<ul>
<li>for <em>master</em> branch take <em>DryWetMIDI.&lt;release_number&gt;-bin-native.zip</em> archive from <a href="https://github.com/melanchall/drywetmidi/releases">Releases</a>;</li>
<li>for <em>develop</em> branch go to <a href="https://dev.azure.com/Melanchall/DryWetMIDI/_build/latest?definitionId=6&amp;branchName=develop">https://dev.azure.com/Melanchall/DryWetMIDI/_build/latest?definitionId=6&amp;branchName=develop</a> and download <em>DryWetMIDI.&lt;release_number&gt;-bin-native.zip</em> from <code>Artifacts</code> → <code>Binaries</code>.</li>
</ul>
<p>(<em>master</em> branch contains code that the library releases built on. <em>develop</em> one is for current development so if you need the latest API, use this branch)</p>
</li>
<li><p>Extract archives into project's <em>Assets</em> → <em>Melanchall</em> → <em>DryWetMIDI</em> folder.</p>
</li>
</ol>
<h2 id="example">Example</h2>
<p>Now you can use DryWetMIDI API in your Unity scripts.</p>
<p>Following sample script (included in demo scene within the <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-222171">full DryWetMIDI package</a>) will create a MIDI file containing all possible notes with length of <code>1/8</code> and will play the file via <code>Microsoft GS Wavetable Synth</code> output device:</p>
<pre><code class="lang-csharp">using System;
using System.Linq;
using System.Text;
using Melanchall.DryWetMidi.Common;
using Melanchall.DryWetMidi.Composing;
using Melanchall.DryWetMidi.Core;
using Melanchall.DryWetMidi.Interaction;
using Melanchall.DryWetMidi.Multimedia;
using Melanchall.DryWetMidi.Standards;
using UnityEngine;

public class DemoScript : MonoBehaviour
{
    private const string OutputDeviceName = &quot;Microsoft GS Wavetable Synth&quot;;

    private OutputDevice _outputDevice;
    private Playback _playback;

    private void Start()
    {
        InitializeOutputDevice();
        var midiFile = CreateTestFile();
        InitializeFilePlayback(midiFile);
        StartPlayback();
    }

    private void OnApplicationQuit()
    {
        Debug.Log(&quot;Releasing playback and device...&quot;);

        if (_playback != null)
        {
            _playback.NotesPlaybackStarted -= OnNotesPlaybackStarted;
            _playback.NotesPlaybackFinished -= OnNotesPlaybackFinished;
            _playback.Dispose();
        }

        if (_outputDevice != null)
            _outputDevice.Dispose();

        Debug.Log(&quot;Playback and device released.&quot;);
    }

    private void InitializeOutputDevice()
    {
        Debug.Log($&quot;Initializing output device [{OutputDeviceName}]...&quot;);

        var allOutputDevices = OutputDevice.GetAll();
        if (!allOutputDevices.Any(d =&gt; d.Name == OutputDeviceName))
        {
            var allDevicesList = string.Join(Environment.NewLine, allOutputDevices.Select(d =&gt; $&quot;  {d.Name}&quot;));
            Debug.Log($&quot;There is no [{OutputDeviceName}] device presented in the system. Here the list of all device:{Environment.NewLine}{allDevicesList}&quot;);
            return;
        }

        _outputDevice = OutputDevice.GetByName(OutputDeviceName);
        Debug.Log($&quot;Output device [{OutputDeviceName}] initialized.&quot;);
    }

    private MidiFile CreateTestFile()
    {
        Debug.Log(&quot;Creating test MIDI file...&quot;);

        var patternBuilder = new PatternBuilder()
            .SetNoteLength(MusicalTimeSpan.Eighth)
            .SetVelocity(SevenBitNumber.MaxValue)
            .ProgramChange(GeneralMidiProgram.Harpsichord);

        foreach (var noteNumber in SevenBitNumber.Values)
        {
            patternBuilder.Note(Melanchall.DryWetMidi.MusicTheory.Note.Get(noteNumber));
        }

        var midiFile = patternBuilder.Build().ToFile(TempoMap.Default);
        Debug.Log(&quot;Test MIDI file created.&quot;);

        return midiFile;
    }

    private void InitializeFilePlayback(MidiFile midiFile)
    {
        Debug.Log(&quot;Initializing playback...&quot;);

        _playback = midiFile.GetPlayback(_outputDevice);
        _playback.Loop = true;
        _playback.NotesPlaybackStarted += OnNotesPlaybackStarted;
        _playback.NotesPlaybackFinished += OnNotesPlaybackFinished;
       
        Debug.Log($&quot;Output device [{OutputDeviceName}] initialized.&quot;);
    }

    private void StartPlayback()
    {
        Debug.Log(&quot;Starting playback...&quot;);
        _playback.Start();
    }

    private void OnNotesPlaybackFinished(object sender, NotesEventArgs e)
    {
        LogNotes(&quot;Notes finished:&quot;, e);
    }

    private void OnNotesPlaybackStarted(object sender, NotesEventArgs e)
    {
        LogNotes(&quot;Notes started:&quot;, e);
    }

    private void LogNotes(string title, NotesEventArgs e)
    {
        var message = new StringBuilder()
            .AppendLine(title)
            .AppendLine(string.Join(Environment.NewLine, e.Notes.Select(n =&gt; $&quot;  {n}&quot;)))
            .ToString();
        Debug.Log(message.Trim());
    }
}
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Pay attention to <code>OnApplicationQuit</code> method. You should always take care about disposing MIDI devices. Without it all resources taken by the device will live until GC collect them. In case of Unity it means Unity may need be reopened to be able to use the same devices again (for example, on Windows).</p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            2024 / Generated by <a href="https://dotnet.github.io/docfx">DocFX</a>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
