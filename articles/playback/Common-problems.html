<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Common problems | DryWetMIDI </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Common problems | DryWetMIDI ">
    <meta name="generator" content="docfx 2.56.0.0">
    
    <link rel="shortcut icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="a_playback_commonproblems">
<h1 id="common-problems">Common problems</h1>

<h2 id="playback-doesnt-produce-sound-or-events-logs">Playback doesn't produce sound or events logs</h2>
<p>Make sure an instance of <a class="xref" href="../../api/Melanchall.DryWetMidi.Devices.Playback.html">Playback</a> class is holded by class field, global variable or something else that can live longer that method where you instantiate <code>Playback</code>. In this case</p>
<pre><code class="lang-csharp">private void StartPlayback()
{
    var playback = _midiFile.GetPlayback();
    playback.Start();
}
</code></pre>
<p><code>playback</code> variable will &quot;die&quot; (will be ready to be collected by GC) after program exits <code>StartPlayback</code> method so playback won't work.</p>
<h2 id="unity-hangs-or-crash-on-entering-play-mode-second-time">Unity hangs or crash on entering Play mode second time</h2>
<p>By default <code>Playback</code> uses <a class="xref" href="../../api/Melanchall.DryWetMidi.Devices.HighPrecisionTickGenerator.html">HighPrecisionTickGenerator</a> tick generator (see <a href="Tick-generator.html">Tick generator</a> article to learn more). <code>HighPrecisionTickGenerator</code> uses WinAPI methods by P/Invoke wich causes troubles in Unity environment. You may notice that Unity hangs forever if you hit Play button second time. Unfortunately it seems the <a href="https://issuetracker.unity3d.com/issues/editor-freezes-when-updating-a-nativearray-on-the-net-4-dot-x-scripting-runtime-and-entering-play-mode-a-second-time">problem</a> won't be fixed. Answer of Unity tech support:</p>
<blockquote>
<p>Unfortunately, that is correct = we will not be able to fix this in the near term because it probably requires rewriting of internal threading functionality, which might introduce new issues. The main case has been tagged for a revisit internally, but it will probably be months until the case is re-valuated again.</p>
</blockquote>
<p>Solution is to use either <a class="xref" href="../../api/Melanchall.DryWetMidi.Devices.RegularPrecisionTickGenerator.html">RegularPrecisionTickGenerator</a> or a <a href="Tick-generator.html#custom-tick-generator">custom</a> one. Related issues on GitHub:</p>
<ul>
<li><a href="https://github.com/melanchall/drywetmidi/issues/31">Playback produces unexpected results in Unity</a></li>
<li><a href="https://github.com/melanchall/drywetmidi/issues/79">Visualization of notes</a></li>
</ul>
<h2 id="setactive-can-only-be-called-from-the-main-thread-in-unity">SetActive can only be called from the main thread in Unity</h2>
<p>Sometimes you want to handle <a class="xref" href="../../api/Melanchall.DryWetMidi.Devices.Playback.html#events">playback events</a> or use <a href="Melanchall.DryWetMidi.Devices.Playback.EventCallback">event</a> or <a href="Melanchall.DryWetMidi.Devices.Playback.NoteCallback">note</a> callbacks. Your code can be executed on separate thread in these cases. It can happen because of <code>Playback</code>'s internals (like <a href="Tick-generator.html">tick generator</a>'s tick handling) work on separate thread.</p>
<p>But UI related things like call of <code>SetActive</code> can be executed on UI thread only. You can use the solution from here: <a href="https://stackoverflow.com/a/56715254/2975589">https://stackoverflow.com/a/56715254/2975589</a>.</p>
<p>Related issues on GitHub:</p>
<ul>
<li><a href="https://github.com/melanchall/drywetmidi/issues/85">trigger object with a note in Unity</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Generated by <a href="https://dotnet.github.io/docfx">DocFX</a>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
