<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Overview | DryWetMIDI </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Overview | DryWetMIDI ">
    
    
      <link rel="shortcut icon" href="images/favicon.png">
      <link rel="stylesheet" href="styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="styles/docfx.css">
      <link rel="stylesheet" href="styles/main.css">
      <meta property="docfx:navrel" content="toc.html">
      <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p><img src="https://raw.githubusercontent.com/melanchall/drywetmidi/develop/Resources/Images/dwm-logo.png" alt="DryWetMIDI Logo"></p>
<p><a href="https://www.nuget.org/packages/Melanchall.DryWetMidi/"><img src="https://img.shields.io/nuget/v/Melanchall.DryWetMidi.svg?label=NuGet%20(full)&amp;color=5295D0" alt="NuGet (full)"></a> <a href="https://www.nuget.org/packages/Melanchall.DryWetMidi.Nativeless/"><img src="https://img.shields.io/nuget/v/Melanchall.DryWetMidi.Nativeless.svg?label=NuGet%20(nativeless)&amp;color=5295D0" alt="NuGet (nativeless)"></a> <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-222171"><img src="https://img.shields.io/static/v1?label=Unity%20Asset%20(full)&amp;message=v7.2.0&amp;color=5295D0" alt="Unity asset (full)"></a> <a href="https://assetstore.unity.com/packages/tools/audio/drywetmidi-nativeless-228998"><img src="https://img.shields.io/static/v1?label=Unity%20Asset%20(nativeless)&amp;message=v7.2.0&amp;color=5295D0" alt="Unity asset (nativeless)"></a></p>
<h1 id="overview">Overview</h1>
<p>DryWetMIDI is the .NET library to work with MIDI data and MIDI devices. It allows:</p>
<ul>
<li>Read, write and create <a href="https://midi.org/standard-midi-files-specification">Standard MIDI Files (SMF)</a>. It is also possible to read <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000120.shtml">RMID</a> files where SMF wrapped to RIFF chunk. You can easily catch specific error when reading or writing MIDI file since all possible errors in a MIDI file are presented as separate exception classes.</li>
<li><a href="https://melanchall.github.io/drywetmidi/articles/devices/Output-device.html">Send</a> MIDI events to/<a href="https://melanchall.github.io/drywetmidi/articles/devices/Input-device.html">receive</a> them from MIDI devices, <a href="https://melanchall.github.io/drywetmidi/articles/playback/Overview.html">play</a> MIDI data and <a href="https://melanchall.github.io/drywetmidi/articles/recording/Overview.html">record</a> it. This APIs support Windows and macOS.</li>
<li>Finely adjust process of reading and writing. It allows, for example, to read corrupted files and repair them, or build MIDI file validators.</li>
<li>Implement <a href="https://melanchall.github.io/drywetmidi/articles/custom-data-structures/Custom-meta-events.html">custom meta events</a> and <a href="https://melanchall.github.io/drywetmidi/articles/custom-data-structures/Custom-chunks.html">custom chunks</a> that can be written to and read from MIDI files.</li>
<li>Manage content of a MIDI file either with low-level objects, like event, or high-level ones, like note (read the <strong>High-level data managing</strong> section of the <a href="https://melanchall.github.io/drywetmidi">library docs</a>).</li>
<li>Build musical compositions (see <a href="https://melanchall.github.io/drywetmidi/articles/composing/Pattern.html">Pattern</a> page of the library docs) and use music theory API (see <a href="https://melanchall.github.io/drywetmidi/articles/music-theory/Overview.html">Music Theory - Overview</a> article).</li>
<li>Perform complex tasks like quantizing, notes splitting or converting MIDI file to CSV representation (see <a href="https://melanchall.github.io/drywetmidi/articles/tools/Overview.html">Tools</a> page of the library docs).</li>
</ul>
<p>Please see <a href="#getting-started">Getting started</a> section below for quick jump into the library.</p>
<blockquote>
<p><strong>Warning</strong><br>
If you want to create an issue or a discussion, read this article first – <a href="https://melanchall.github.io/drywetmidi/articles/dev/Support.html">Support</a>.</p>
</blockquote>
<h2 id="useful-links">Useful Links</h2>
<ul>
<li><a href="https://www.nuget.org/packages/Melanchall.DryWetMidi">NuGet</a></li>
<li><a href="https://melanchall.github.io/drywetmidi">Documentation</a></li>
<li><a href="https://melanchall.github.io/drywetmidi/articles/dev/Project-health.html">Project health</a></li>
<li>CodeProject articles:
<ul>
<li><a href="https://www.codeproject.com/Articles/1200014/DryWetMIDI-High-level-processing-of-MIDI-files">DryWetMIDI: High-Level Processing of MIDI Files</a></li>
<li><a href="https://www.codeproject.com/Articles/1204629/DryWetMIDI-Notes-Quantization">DryWetMIDI: Notes Quantization</a></li>
<li><a href="https://www.codeproject.com/Articles/1275475/DryWetMIDI-Working-with-MIDI-Devices">DryWetMIDI: Working with MIDI Devices</a></li>
</ul>
</li>
</ul>
<h2 id="projects-using-drywetmidi">Projects using DryWetMIDI</h2>
<p>Here the list of noticeable projects that use DryWetMIDI:</p>
<ul>
<li><a href="https://www.enttec.com/product/dmx-lighting-control-software/emu-sound-to-light-controller">EMU – Sound to Light Controller</a><br>
EMU (DMXIS’s next generation) is a state-of-the-art, intuitive sound-to-light controller designed for professional live musicians and DJs. Easy to use software, EMU allows you to run automated or responsive DMX light shows, leaving you to focus on your show!</li>
<li><a href="https://musicalbits.de">Musical Bits</a><br>
Musical Bits creates software that helps you creating music. Our software uses latest technology, including AI, to model all layers of creativity of a human composer. These layers are implemented as reusable and combinable software components. Musical Bits software is available as co-pilot for producers and composers under the name KLANGMACHT and helps you create, drumsounds, beats, guitars, background choirs, lyrics and more. We even create and distribute full virtual bands, albums and songs. For example, check out the Frostbite Orckings.</li>
<li><a href="https://coyotemidi.com">CoyoteMIDI</a><br>
CoyoteMIDI extends the functionality of your MIDI devices to include keyboard and mouse input, including complex key combinations and multi-step macros.</li>
<li><a href="https://clonehero.net">Clone Hero</a><br>
Free rhythm game, which can be played with any 5 or 6 button guitar controller, game controllers, or just your standard computer keyboard. The game is a clone of Guitar Hero.</li>
<li><a href="https://kaiclavier.itch.io/electrophonics">Electrophonics</a><br>
A collection of virtual musical instruments that features real MIDI output.</li>
<li><a href="https://store.steampowered.com/app/1222580/Rustissimo">Rustissimo</a><br>
Using Rustissimo you can create a concert with your friends and play instruments with synchronization.</li>
</ul>
<p>If you find that DryWetMIDI has been useful for your project, please put a link to the library in your project's About section or something like that.</p>
<h2 id="getting-started">Getting Started</h2>
<p>Let's see some examples of what you can do with DryWetMIDI. Also you can check out sample applications from <a href="https://github.com/CIRCE-EYES">CIRCE-EYES</a> (see the profile, VB.NET used).</p>
<p>To <a href="https://melanchall.github.io/drywetmidi/articles/file-reading-writing/MIDI-file-reading.html">read a MIDI file</a> you have to use <code>Read</code> static method of the <code>MidiFile</code>:</p>
<pre><code class="lang-csharp">var midiFile = MidiFile.Read(&quot;Some Great Song.mid&quot;);
</code></pre>
<p>or, in more advanced form (visit <a href="https://melanchall.github.io/drywetmidi/api/Melanchall.DryWetMidi.Core.ReadingSettings.html">Reading settings</a> page on the library docs to learn more about how to adjust process of reading)</p>
<pre><code class="lang-csharp">var midiFile = MidiFile.Read(
    &quot;Some Great Song.mid&quot;,
    new ReadingSettings
    {
        NoHeaderChunkPolicy = NoHeaderChunkPolicy.Abort,
        CustomChunkTypes = new ChunkTypesCollection
        {
            { typeof(MyCustomChunk), &quot;Cstm&quot; }
        }
    });
</code></pre>
<p>To <a href="https://melanchall.github.io/drywetmidi/articles/file-reading-writing/MIDI-file-writing.html">write MIDI data to a file</a> you have to use <code>Write</code> method of the <code>MidiFile</code>:</p>
<pre><code class="lang-csharp">midiFile.Write(&quot;My Great Song.mid&quot;);
</code></pre>
<p>or, in more advanced form (visit <a href="https://melanchall.github.io/drywetmidi/api/Melanchall.DryWetMidi.Core.WritingSettings.html">Writing settings</a> page on the library docs to learn more about how to adjust process of writing)</p>
<pre><code class="lang-csharp">midiFile.Write(
    &quot;My Great Song.mid&quot;,
    true,
    MidiFileFormat.SingleTrack,
    new WritingSettings
    {
        UseRunningStatus = true,
        NoteOffAsSilentNoteOn = true
    });
</code></pre>
<p>Of course you can create a MIDI file from scratch by creating an instance of the <code>MidiFile</code> and writing it:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
    new TrackChunk(
        new SetTempoEvent(500000)),
    new TrackChunk(
        new TextEvent(&quot;It's just single note track...&quot;),
        new NoteOnEvent((SevenBitNumber)60, (SevenBitNumber)45),
        new NoteOffEvent((SevenBitNumber)60, (SevenBitNumber)0)
        {
            DeltaTime = 400
        }));

midiFile.Write(&quot;My Future Great Song.mid&quot;);
</code></pre>
<p>or</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile();
TempoMap tempoMap = midiFile.GetTempoMap();

var trackChunk = new TrackChunk();
using (var notesManager = trackChunk.ManageNotes())
{
    NotesCollection notes = notesManager.Objects;
    notes.Add(new Note(
        NoteName.A,
        4,
        LengthConverter.ConvertFrom(
            new MetricTimeSpan(hours: 0, minutes: 0, seconds: 10),
            0,
            tempoMap)));
}

midiFile.Chunks.Add(trackChunk);
midiFile.Write(&quot;My Future Great Song.mid&quot;);
</code></pre>
<p>If you want to speed up playing back a MIDI file by two times you can do it with this code:</p>
<pre><code class="lang-csharp">foreach (var trackChunk in midiFile.Chunks.OfType&lt;TrackChunk&gt;())
{
    foreach (var setTempoEvent in trackChunk.Events.OfType&lt;SetTempoEvent&gt;())
    {
        setTempoEvent.MicrosecondsPerQuarterNote /= 2;
    }
}
</code></pre>
<p>Of course this code is simplified. In practice a MIDI file may not contain SetTempo event which means it has the default one (500,000 microseconds per beat).</p>
<p>Instead of modifying a MIDI file you can use <a href="https://melanchall.github.io/drywetmidi/api/Melanchall.DryWetMidi.Multimedia.Playback.html"><code>Playback</code></a> class:</p>
<pre><code class="lang-csharp">using (var outputDevice = OutputDevice.GetByName(&quot;Microsoft GS Wavetable Synth&quot;))
using (var playback = midiFile.GetPlayback(outputDevice))
{
    playback.Speed = 2.0;
    playback.Play();
}
</code></pre>
<p>To get duration of a MIDI file as <code>TimeSpan</code> use this code:</p>
<pre><code class="lang-csharp">TempoMap tempoMap = midiFile.GetTempoMap();
TimeSpan midiFileDuration = midiFile
    .GetTimedEvents()
    .LastOrDefault(e =&gt; e.Event is NoteOffEvent)
    ?.TimeAs&lt;MetricTimeSpan&gt;(tempoMap) ?? new MetricTimeSpan();
</code></pre>
<p>or simply:</p>
<pre><code class="lang-csharp">TimeSpan midiFileDuration = midiFile.GetDuration&lt;MetricTimeSpan&gt;();
</code></pre>
<p>Suppose you want to remove all C# notes from a MIDI file. It can be done with this code:</p>
<pre><code class="lang-csharp">foreach (var trackChunk in midiFile.GetTrackChunks())
{
    using (var notesManager = trackChunk.ManageNotes())
    {
        notesManager.Objects.RemoveAll(n =&gt; n.NoteName == NoteName.CSharp);
    }
}
</code></pre>
<p>or</p>
<pre><code class="lang-csharp">midiFile.RemoveNotes(n =&gt; n.NoteName == NoteName.CSharp);
</code></pre>
<p>To get all chords of a MIDI file at 20 seconds from the start of the file write this:</p>
<pre><code class="lang-csharp">TempoMap tempoMap = midiFile.GetTempoMap();
IEnumerable&lt;Chord&gt; chordsAt20seconds = midiFile
    .GetChords()
    .AtTime(
        new MetricTimeSpan(0, 0, 20),
        tempoMap,
        LengthedObjectPart.Entire);
</code></pre>
<p>To create a MIDI file with single note which length will be equal to length of two triplet eighth notes you can use this code:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile();
var tempoMap = midiFile.GetTempoMap();

var trackChunk = new TrackChunk();
using (var notesManager = trackChunk.ManageNotes())
{
    var length = LengthConverter.ConvertFrom(
        2 * MusicalTimeSpan.Eighth.Triplet(),
        0,
        tempoMap);
    var note = new Note(NoteName.A, 4, length);
    notesManager.Objects.Add(note);
}

midiFile.Chunks.Add(trackChunk);
midiFile.Write(&quot;Single note great song.mid&quot;);
</code></pre>
<p>You can even build a musical composition:</p>
<pre><code class="lang-csharp">Pattern pattern = new PatternBuilder()
     
    // Insert a pause of 5 seconds
    .StepForward(new MetricTimeSpan(0, 0, 5))

    // Insert an eighth C# note of the 4th octave
    .Note(Octave.Get(4).CSharp, MusicalTimeSpan.Eighth)

    // Set default note length to triplet eighth and default octave to 5
    .SetNoteLength(MusicalTimeSpan.Eighth.Triplet())
    .SetOctave(Octave.Get(5))

    // Now we can add triplet eighth notes of the 5th octave in a simple way
    .Note(NoteName.A)
    .Note(NoteName.B)
    .Note(NoteName.GSharp)

    // Insert a simple drum pattern
    .PianoRoll(@&quot;
        F#2   ||||||||
        D2    --|---|-
        C2    |---|---&quot;)
    .Repeat(9)

    // Get pattern
    .Build();

MidiFile midiFile = pattern.ToFile(TempoMap.Default);
</code></pre>
<p>DryWetMIDI provides <a href="https://melanchall.github.io/drywetmidi/articles/devices/Overview.html">devices API</a> allowing to send MIDI events to and receive them from MIDI devices. Following example shows how to send events to MIDI device and handle them as they are received by the device:</p>
<pre><code class="lang-csharp">using System;
using Melanchall.DryWetMidi.Multimedia;
using Melanchall.DryWetMidi.Core;

// ...

using (var outputDevice = OutputDevice.GetByName(&quot;MIDI Device&quot;))
{
    outputDevice.EventSent += OnEventSent;

    using (var inputDevice = InputDevice.GetByName(&quot;MIDI Device&quot;))
    {
        inputDevice.EventReceived += OnEventReceived;
        inputDevice.StartEventsListening();

        outputDevice.SendEvent(new NoteOnEvent());
        outputDevice.SendEvent(new NoteOffEvent());
    }
}

// ...

private void OnEventReceived(object sender, MidiEventReceivedEventArgs e)
{
    var midiDevice = (MidiDevice)sender;
    Console.WriteLine($&quot;Event received from '{midiDevice.Name}' at {DateTime.Now}: {e.Event}&quot;);
}

private void OnEventSent(object sender, MidiEventSentEventArgs e)
{
    var midiDevice = (MidiDevice)sender;
    Console.WriteLine($&quot;Event sent to '{midiDevice.Name}' at {DateTime.Now}: {e.Event}&quot;);
}
</code></pre>
<h2 id="sast-tools">SAST Tools</h2>
<ul>
<li><a href="https://jb.gg/OpenSourceSupport">JetBrains All Products Pack</a> – all JetBrains desktop tools by open source license.</li>
<li><a href="https://pvs-studio.com/en/pvs-studio/?utm_source=website&amp;utm_medium=github&amp;utm_campaign=open_source">PVS-Studio</a> – static analyzer for C, C++, C#, and Java code.</li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      2024 / Generated by <a href="https://dotnet.github.io/docfx">DocFX</a>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
