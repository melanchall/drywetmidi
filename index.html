<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Features | DryWetMIDI </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Features | DryWetMIDI ">
    <meta name="generator" content="docfx 2.48.1.0">
    
    <link rel="shortcut icon" href="images/favicon.png">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p><img src="https://github.com/melanchall/drywetmidi/blob/develop/Resources/Images/dwm-logo.png?raw=true" alt="DryWetMIDI Logo"></p>
<p><a href="https://www.nuget.org/packages/Melanchall.DryWetMidi/"><img src="https://img.shields.io/nuget/v/Melanchall.DryWetMidi.svg" alt="NuGet"></a> <a href="https://dev.azure.com/Melanchall/DryWetMIDI/_build/latest?definitionId=1&amp;branchName=develop"><img src="https://dev.azure.com/Melanchall/DryWetMIDI/_apis/build/status/Windows/%5BWindows%5D%20Build%20and%20test?branchName=develop" alt="Build Status"></a></p>
<p>DryWetMIDI is the .NET library to work with MIDI files and MIDI devices. Visit <a href="https://github.com/melanchall/drymidi/wiki">Wiki</a> to learn how to use the DryWetMIDI. The library was tested on 130,000 files taken from <a href="https://www.reddit.com/r/WeAreTheMusicMakers/comments/3ajwe4/the_largest_midi_collection_on_the_internet/">here</a>. Thanks <em>midi-man</em> for this great collection. You can get the latest version via <a href="https://www.nuget.org/packages/Melanchall.DryWetMidi">NuGet</a>.</p>
<h2 id="features">Features</h2>
<p>With the DryWetMIDI you can:</p>
<ul>
<li>Read, write and create <a href="https://www.midi.org/specifications/category/smf-specifications">Standard MIDI Files (SMF)</a>. It is also possible to read <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000120.shtml">RMID</a> files where SMF wrapped to RIFF chunk.</li>
<li><a href="https://github.com/melanchall/drywetmidi/wiki/Output-device">Send</a> MIDI events to/<a href="https://github.com/melanchall/drywetmidi/wiki/Input-device">receive</a> them from MIDI devices, <a href="https://github.com/melanchall/drywetmidi/wiki/Playback">play</a> MIDI data and <a href="https://github.com/melanchall/drywetmidi/wiki/Recording">record</a> it.</li>
<li>Finely adjust process of reading and writing. It allows, for example, to read corrupted files and repair them, or build MIDI file validators.</li>
<li>Implement <a href="https://github.com/melanchall/drywetmidi/wiki/Custom-meta-events">custom meta events</a> and <a href="https://github.com/melanchall/drywetmidi/wiki/Custom-chunks">custom chunks</a> that can be written to and read from MIDI files.</li>
<li>Easily catch specific error when reading or writing MIDI file since all possible errors in a MIDI file are presented as separate exception classes.</li>
<li>Manage content of a MIDI file either with low-level objects, like event, or high-level ones, like note (read the <strong>High-level data managing</strong> section of the Wiki).</li>
<li>Build musical compositions (see <a href="https://github.com/melanchall/drywetmidi/wiki/Pattern">Pattern</a> page of the library Wiki).</li>
<li>Perform complex tasks like quantizing, notes splitting or converting MIDI file to CSV representation (see <a href="https://github.com/melanchall/drywetmidi/wiki/Tools">Tools</a> page of the Wiki).</li>
</ul>
<h2 id="documentation">Documentation</h2>
<p>Complete documentation including API reference is available on <a href="https://melanchall.github.io/drywetmidi">https://melanchall.github.io/drywetmidi</a>.</p>
<h2 id="projects-using-drywetmidi">Projects using DryWetMIDI</h2>
<p>Here the list of noticeable projects that use DryWetMIDI:</p>
<ul>
<li><a href="https://clonehero.net">Clone Hero</a><br>
Free rhythm game, which can be played with any 5 or 6 button guitar controller, game controllers, or just your standard computer keyboard. The game is a clone of Guitar Hero.</li>
<li><a href="https://kyokogames.itch.io/beatmasters-vr">SOUNDSTORM VR</a><br>
VR rhythm shooter game.</li>
<li><a href="https://kaiclavier.itch.io/electrophonics">Electrophonics</a><br>
A collection of virtual musical instruments that features real MIDI output.</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>There are several articles that can help you dive into API provided by DryWetMIDI:</p>
<ul>
<li><a href="https://www.codeproject.com/Articles/1200014/DryWetMIDI-High-level-processing-of-MIDI-files">DryWetMIDI: High-Level Processing of MIDI Files</a></li>
<li><a href="https://www.codeproject.com/Articles/1204629/DryWetMIDI-Notes-Quantization">DryWetMIDI: Notes Quantization</a></li>
<li><a href="https://www.codeproject.com/Articles/1275475/DryWetMIDI-Working-with-MIDI-Devices">DryWetMIDI: Working with MIDI Devices</a></li>
</ul>
<p>Let's see some examples of what you can do with DryWetMIDI.</p>
<p>To <a href="https://github.com/melanchall/drymidi/wiki/Reading-a-MIDI-file">read a MIDI file</a> you have to use <code>Read</code> static method of the <code>MidiFile</code>:</p>
<pre><code class="lang-csharp">var midiFile = MidiFile.Read(&quot;Some Great Song.mid&quot;);
</code></pre>
<p>or, in more advanced form (visit <a href="https://github.com/melanchall/drywetmidi/wiki/Reading-settings">Reading settings</a> page on Wiki to learn more about how to adjust process of reading)</p>
<pre><code class="lang-csharp">var midiFile = MidiFile.Read(&quot;Some Great Song.mid&quot;,
                             new ReadingSettings
                             {
                                 NoHeaderChunkPolicy = NoHeaderChunkPolicy.Abort,
                                 CustomChunkTypes = new ChunkTypesCollection
                                 {
                                     { typeof(MyCustomChunk), &quot;Cstm&quot; }
                                 }
                             });
</code></pre>
<p>To <a href="https://github.com/melanchall/drymidi/wiki/Writing-a-MIDI-file">write MIDI data to a file</a> you have to use <code>Write</code> method of the <code>MidiFile</code>:</p>
<pre><code class="lang-csharp">midiFile.Write(&quot;My Great Song.mid&quot;);
</code></pre>
<p>or, in more advanced form (visit <a href="https://github.com/melanchall/drywetmidi/wiki/Writing-settings">Writing settings</a> page on Wiki to learn more about how to adjust process of writing)</p>
<pre><code class="lang-csharp">midiFile.Write(&quot;My Great Song.mid&quot;,
               true,
               MidiFileFormat.SingleTrack,
               new WritingSettings
               {
                   CompressionPolicy = CompressionPolicy.Default
               });
</code></pre>
<p>Of course you can create a MIDI file from scratch by creating an instance of the <code>MidiFile</code> and writing it:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile(
                   new TrackChunk(
                       new SetTempoEvent(500000)),
                   new TrackChunk(
                       new TextEvent(&quot;It's just single note track...&quot;),
                       new NoteOnEvent((SevenBitNumber)60, (SevenBitNumber)45),
                       new NoteOffEvent((SevenBitNumber)60, (SevenBitNumber)0)
                       {
                           DeltaTime = 400
                       }));
midiFile.Write(&quot;My Future Great Song.mid&quot;);
</code></pre>
<p>or</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile();
TempoMap tempoMap = midiFile.GetTempoMap();

var trackChunk = new TrackChunk();
using (var notesManager = trackChunk.ManageNotes())
{
    NotesCollection notes = notesManager.Notes;
    notes.Add(new Note(NoteName.A,
                       4,
                       LengthConverter.ConvertFrom(new MetricTimeSpan(hours: 0,
                                                                      minutes: 0,
                                                                      seconds: 10),
                                                   0,
                                                   tempoMap)));
}

midiFile.Chunks.Add(trackChunk);
midiFile.Write(&quot;My Future Great Song.mid&quot;);
</code></pre>
<p>If you want to speed up playing back a MIDI file by two times you can do it with this code:</p>
<pre><code class="lang-csharp">foreach (var trackChunk in midiFile.Chunks.OfType&lt;TrackChunk&gt;())
{
    foreach (var setTempoEvent in trackChunk.Events.OfType&lt;SetTempoEvent&gt;())
    {
        setTempoEvent.MicrosecondsPerQuarterNote /= 2;
    }
}
</code></pre>
<p>Of course this code is simplified. In practice a MIDI file may not contain SetTempo event which means it has the default one (500,000 microseconds per beat).</p>
<p>Instead of modifying a MIDI file you can use <a href="https://github.com/melanchall/drywetmidi/wiki/Playback"><code>Playback</code></a> class:</p>
<pre><code class="lang-csharp">using (var outputDevice = OutputDevice.GetByName(&quot;Microsoft GS Wavetable Synth&quot;))
using (var playback = midiFile.GetPlayback(outputDevice))
{
    playback.Speed = 2.0;
    playback.Play();
}
</code></pre>
<p>To get duration of a MIDI file as <code>TimeSpan</code> use this code:</p>
<pre><code class="lang-csharp">TempoMap tempoMap = midiFile.GetTempoMap();
TimeSpan midiFileDuration = midiFile.GetTimedEvents()
                                    .LastOrDefault(e =&gt; e.Event is NoteOffEvent)
                                    ?.TimeAs&lt;MetricTimeSpan&gt;(tempoMap) ?? new MetricTimeSpan();
</code></pre>
<p>Suppose you want to remove all C# notes from a MIDI file. It can be done with this code:</p>
<pre><code class="lang-csharp">foreach (var trackChunk in midiFile.GetTrackChunks())
{
    using (var notesManager = trackChunk.ManageNotes())
    {
        notesManager.Notes.RemoveAll(n =&gt; n.NoteName == NoteName.CSharp);
    }
}
</code></pre>
<p>or</p>
<pre><code class="lang-csharp">midiFile.RemoveNotes(n =&gt; n.NoteName == NoteName.CSharp);
</code></pre>
<p>To get all chords of a MIDI file at 20 seconds from the start of the file write this:</p>
<pre><code class="lang-csharp">TempoMap tempoMap = midiFile.GetTempoMap();
IEnumerable&lt;Chord&gt; chordsAt20seconds = midiFile.GetChords()
                                               .AtTime(new MetricTimeSpan(0, 0, 20),
                                                       tempoMap,
                                                       LengthedObjectPart.Entire);
</code></pre>
<p>To create a MIDI file with single note which length will be equal to length of two triplet eighth notes you can use this code:</p>
<pre><code class="lang-csharp">var midiFile = new MidiFile();
var tempoMap = midiFile.GetTempoMap();

var trackChunk = new TrackChunk();
using (var notesManager = trackChunk.ManageNotes())
{
    var length = LengthConverter.ConvertFrom(2 * MusicalTimeSpan.Eighth.Triplet(),
                                             0,
                                             tempoMap);
    var note = new Note(NoteName.A, 4, length);
    notesManager.Notes.Add(note);
}

midiFile.Chunks.Add(trackChunk);
midiFile.Write(&quot;Single note great song.mid&quot;);
</code></pre>
<p>You can even build a musical composition:</p>
<pre><code class="lang-csharp">Pattern pattern = new PatternBuilder()
     
    // Insert a pause of 5 seconds
    .StepForward(new MetricTimeSpan(0, 0, 5))

    // Insert an eighth C# note of the 4th octave
    .Note(Octave.Get(4).CSharp, MusicalTimeSpan.Eighth)

    // Set default note length to triplet eighth and default octave to 5
    .SetNoteLength(MusicalTimeSpan.Eighth.Triplet())
    .SetOctave(Octave.Get(5))

    // Now we can add triplet eighth notes of the 5th octave in a simple way
    .Note(NoteName.A)
    .Note(NoteName.B)
    .Note(NoteName.GSharp)

    // Get pattern
    .Build();

MidiFile midiFile = pattern.ToFile(TempoMap.Default);
</code></pre>
<p>DryWetMIDI provides <a href="https://github.com/melanchall/drywetmidi/wiki/MIDI-devices">devices API</a> allowing to send MIDI events to and receive them from MIDI devices. Following example shows how to send events to MIDI device and handle them as they are received by the device:</p>
<pre><code class="lang-csharp">using System;
using Melanchall.DryWetMidi.Devices;
using Melanchall.DryWetMidi.Core;

// ...

using (var outputDevice = OutputDevice.GetByName(&quot;MIDI Device&quot;))
{
    outputDevice.EventSent += OnEventSent;

    using (var inputDevice = InputDevice.GetByName(&quot;MIDI Device&quot;))
    {
        inputDevice.EventReceived += OnEventReceived;
        inputDevice.StartEventsListening();

        outputDevice.SendEvent(new NoteOnEvent());
        outputDevice.SendEvent(new NoteOffEvent());
    }
}

// ...

private void OnEventReceived(object sender, MidiEventReceivedEventArgs e)
{
    var midiDevice = (MidiDevice)sender;
    Console.WriteLine($&quot;Event received from '{midiDevice.Name}' at {DateTime.Now}: {e.Event}&quot;);
}

private void OnEventSent(object sender, MidiEventSentEventArgs e)
{
    var midiDevice = (MidiDevice)sender;
    Console.WriteLine($&quot;Event sent to '{midiDevice.Name}' at {DateTime.Now}: {e.Event}&quot;);
}
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Generated by <b>DocFX</b> on February 2, 2020 00:00:48
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
